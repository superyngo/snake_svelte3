var dt=Object.defineProperty;var ft=(t,e,n)=>e in t?dt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var w=(t,e,n)=>(ft(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function L(){}function st(t){return t()}function F(){return Object.create(null)}function H(t){t.forEach(st)}function it(t){return typeof t=="function"}function ot(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function mt(t){return Object.keys(t).length===0}function Z(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function E(t){t.parentNode&&t.parentNode.removeChild(t)}function P(t){return document.createElement(t)}function pt(t){return document.createTextNode(t)}function Y(){return pt(" ")}function B(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function C(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function gt(t){return Array.from(t.childNodes)}function R(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}let N;function X(t){N=t}function rt(){if(!N)throw new Error("Function called outside component initialization");return N}function yt(t){rt().$$.on_mount.push(t)}function wt(t){rt().$$.on_destroy.push(t)}const D=[],z=[];let J=[];const U=[],_t=Promise.resolve();let G=!1;function vt(){G||(G=!0,_t.then(at))}function V(t){J.push(t)}const $=new Set;let j=0;function at(){if(j!==0)return;const t=N;do{try{for(;j<D.length;){const e=D[j];j++,X(e),bt(e.$$)}}catch(e){throw D.length=0,j=0,e}for(X(null),D.length=0,j=0;z.length;)z.pop()();for(let e=0;e<J.length;e+=1){const n=J[e];$.has(n)||($.add(n),n())}J.length=0}while(D.length);for(;U.length;)U.pop()();G=!1,$.clear(),X(t)}function bt(t){if(t.fragment!==null){t.update(),H(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(V)}}function kt(t){const e=[],n=[];J.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),J=e}const x=new Set;let St;function T(t,e){t&&t.i&&(x.delete(t),t.i(e))}function It(t,e,n,s){if(t&&t.o){if(x.has(t))return;x.add(t),St.c.push(()=>{x.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function q(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Ct(t,e){t.d(1),e.delete(t.key)}function At(t,e,n,s,i,r,m,f,o,p,S,k){let h=t.length,d=r.length,v=h;const W={};for(;v--;)W[t[v].key]=v;const u=[],c=new Map,a=new Map,l=[];for(v=d;v--;){const y=k(i,r,v),I=n(y);let A=m.get(I);A?s&&l.push(()=>A.p(y,e)):(A=p(I,y),A.c()),c.set(I,u[v]=A),I in W&&a.set(I,Math.abs(v-W[I]))}const _=new Set,b=new Set;function g(y){T(y,1),y.m(f,S),m.set(y.key,y),S=y.first,d--}for(;h&&d;){const y=u[d-1],I=t[h-1],A=y.key,O=I.key;y===I?(S=y.first,h--,d--):c.has(O)?!m.has(A)||_.has(A)?g(y):b.has(O)?h--:a.get(A)>a.get(O)?(b.add(A),g(y)):(_.add(O),h--):(o(I,m),h--)}for(;h--;){const y=t[h];c.has(y.key)||o(y,m)}for(;d;)g(u[d-1]);return H(l),u}function Pt(t){t&&t.c()}function lt(t,e,n){const{fragment:s,after_update:i}=t.$$;s&&s.m(e,n),V(()=>{const r=t.$$.on_mount.map(st).filter(it);t.$$.on_destroy?t.$$.on_destroy.push(...r):H(r),t.$$.on_mount=[]}),i.forEach(V)}function ct(t,e){const n=t.$$;n.fragment!==null&&(kt(n.after_update),H(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Wt(t,e){t.$$.dirty[0]===-1&&(D.push(t),vt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(t,e,n,s,i,r,m,f=[-1]){const o=N;X(t);const p=t.$$={fragment:null,ctx:[],props:r,update:L,not_equal:i,bound:F(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:F(),dirty:f,skip_bound:!1,root:e.target||o.$$.root};m&&m(p.root);let S=!1;if(p.ctx=n?n(t,e.props||{},(k,h,...d)=>{const v=d.length?d[0]:h;return p.ctx&&i(p.ctx[k],p.ctx[k]=v)&&(!p.skip_bound&&p.bound[k]&&p.bound[k](v),S&&Wt(t,k)),h}):[],p.update(),S=!0,H(p.before_update),p.fragment=s?s(p.ctx):!1,e.target){if(e.hydrate){const k=gt(e.target);p.fragment&&p.fragment.l(k),k.forEach(E)}else p.fragment&&p.fragment.c();e.intro&&T(t.$$.fragment),lt(t,e.target,e.anchor),at()}X(o)}class ht{constructor(){w(this,"$$");w(this,"$$set")}$destroy(){ct(this,1),this.$destroy=L}$on(e,n){if(!it(n))return L;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!mt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Zt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Zt);function Q(t,e,n){const s=t.slice();return s[14]=e[n],s[16]=n,s}function K(t){let e,n,s;return{c(){e=P("button"),e.textContent="start"},m(i,r){M(i,e,r),n||(s=B(e,"click",t[4]),n=!0)},p:L,d(i){i&&E(e),n=!1,s()}}}function tt(t){let e,n,s;return{c(){e=P("button"),e.textContent="pause"},m(i,r){M(i,e,r),n||(s=B(e,"click",t[5]),n=!0)},p:L,d(i){i&&E(e),n=!1,s()}}}function et(t){let e,n;return{c(){e=P("div"),n=P("div"),n.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketchjs="https://sketch.io/dtd/" sketchjs:metadata="eyJuYW1lIjoiRHJhd2luZy0zLnNrZXRjaHBhZCIsInN1cmZhY2UiOnsiaXNQYWludCI6dHJ1ZSwibWV0aG9kIjoiZmlsbCIsImJsZW5kIjoibm9ybWFsIiwiZW5hYmxlZCI6dHJ1ZSwib3BhY2l0eSI6MSwidHlwZSI6InBhdHRlcm4iLCJwYXR0ZXJuIjp7InR5cGUiOiJwYXR0ZXJuIiwicmVmbGVjdCI6Im5vLXJlZmxlY3QiLCJyZXBlYXQiOiJyZXBlYXQiLCJzbW9vdGhpbmciOmZhbHNlLCJzcmMiOiJ0cmFuc3BhcmVudExpZ2h0Iiwic3giOjEsInN5IjoxLCJ4MCI6MC41LCJ4MSI6MSwieTAiOjAuNSwieTEiOjF9LCJpc0ZpbGwiOnRydWV9LCJjbGlwUGF0aCI6eyJlbmFibGVkIjp0cnVlLCJzdHlsZSI6eyJzdHJva2VTdHlsZSI6ImJsYWNrIiwibGluZVdpZHRoIjoxfX0sImRlc2NyaXB0aW9uIjoiTWFkZSB3aXRoIFNrZXRjaHBhZCIsIm1ldGFkYXRhIjp7fSwiZXhwb3J0RFBJIjo3MiwiZXhwb3J0Rm9ybWF0IjoicG5nIiwiZXhwb3J0UXVhbGl0eSI6MC45NSwidW5pdHMiOiJweCIsIndpZHRoIjozMDAsImhlaWdodCI6MjAwLCJwYWdlcyI6W3sid2lkdGgiOjMwMCwiaGVpZ2h0IjoyMDB9XSwidXVpZCI6IjgxZTU3N2I2LWE2ZmYtNDNkNS1hNGU3LWQ0ZWVmMThhMjVkOCJ9" width="50" height="200" viewBox="0 0 300 200"><path style="fill: #d7066f; stroke: #000000; mix-blend-mode: source-over; paint-order: stroke fill markers; fill-opacity: 1; stroke-dasharray: none; stroke-dashoffset: 0; stroke-linecap: round; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1; stroke-width: 4;" sketchjs:tool="path" d="M9.96 32.41 C31.96 5.41 54.96 -11.59 94.96 9.41 128.96 22.41 135.96 65.41 185.96 64.41 242.96 67.41 295.96 20.41 295.96 20.41 295.96 20.41 247.96 64.41 246.96 64.41 245.96 64.41 317.96 41.41 316.96 41.41 315.96 41.41 194.96 104.41 165.96 110.41 136.96 116.41 129.96 60.41 55.96 66.41 17.96 76.41 12.96 134.41 10.96 134.41 8.96 134.41 -12.04 59.41 9.96 32.41 z" transform="matrix(1,0,0,1,-15.9598774,34.5922776)"></path></svg>',C(n,"class","tongue svelte-1a5ksi8"),C(e,"class","face svelte-1a5ksi8"),R(e,"rotate",t[2].headAngle+"deg")},m(s,i){M(s,e,i),Z(e,n)},p(s,i){i&4&&R(e,"rotate",s[2].headAngle+"deg")},d(s){s&&E(e)}}}function nt(t,e){let n,s,i,r=e[16]===e[2].body[0]&&e[2].status!=e[2].enumStatus.null&&et(e);return{key:t,first:null,c(){n=P("div"),r&&r.c(),s=Y(),C(n,"class",i="brick br"+e[16]+" svelte-1a5ksi8"),this.first=n},m(m,f){M(m,n,f),r&&r.m(n,null),Z(n,s)},p(m,f){e=m,e[16]===e[2].body[0]&&e[2].status!=e[2].enumStatus.null?r?r.p(e,f):(r=et(e),r.c(),r.m(n,s)):r&&(r.d(1),r=null),f&3&&i!==(i="brick br"+e[16]+" svelte-1a5ksi8")&&C(n,"class",i)},d(m){m&&E(n),r&&r.d()}}}function Bt(t){let e,n,s,i,r,m,f,o=[],p=new Map,S,k,h=t[2].status!=t[2].enumStatus.running&&K(t),d=t[2].status===t[2].enumStatus.running&&tt(t),v=q(Array(t[0]*t[1]));const W=u=>u[16];for(let u=0;u<v.length;u+=1){let c=Q(t,v,u),a=W(c);p.set(a,o[u]=nt(a,c))}return{c(){e=P("div"),n=P("div"),h&&h.c(),s=Y(),d&&d.c(),i=Y(),r=P("button"),r.textContent="reset",m=Y(),f=P("div");for(let u=0;u<o.length;u+=1)o[u].c();C(n,"class","control svelte-1a5ksi8"),C(f,"id","canvas"),C(f,"role","button"),C(f,"tabindex",0),R(f,"grid-template-columns","repeat("+t[0]+", auto)"),C(f,"class","svelte-1a5ksi8"),C(e,"class","appWrapper svelte-1a5ksi8")},m(u,c){M(u,e,c),Z(e,n),h&&h.m(n,null),Z(n,s),d&&d.m(n,null),Z(n,i),Z(n,r),Z(e,m),Z(e,f);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(f,null);S||(k=[B(r,"click",t[6]),B(f,"keydown",t[7]),B(f,"touchstart",t[8]),B(f,"touchmove",t[9]),B(f,"touchend",t[10]),B(f,"click",t[11])],S=!0)},p(u,[c]){u[2].status!=u[2].enumStatus.running?h?h.p(u,c):(h=K(u),h.c(),h.m(n,s)):h&&(h.d(1),h=null),u[2].status===u[2].enumStatus.running?d?d.p(u,c):(d=tt(u),d.c(),d.m(n,i)):d&&(d.d(1),d=null),c&7&&(v=q(Array(u[0]*u[1])),o=At(o,c,W,1,u,v,p,f,Ct,nt,null,Q)),c&1&&R(f,"grid-template-columns","repeat("+u[0]+", auto)")},i:L,o:L,d(u){u&&E(e),h&&h.d(),d&&d.d();for(let c=0;c<o.length;c+=1)o[c].d();S=!1,H(k)}}}function Lt(t,e,n){let{canvasWidth:s=10,canvasHeight:i=10,speed:r=5}=e;yt(()=>{const c=document.getElementById("canvas");m(),c.focus(),window.onresize=m}),wt(()=>o.stop());function m(){const c=document.querySelector(".appWrapper"),a=document.querySelector(".control"),l=+getComputedStyle(c).height.replace("px","")-+getComputedStyle(a).height.replace("px","")-+getComputedStyle(c).padding.replace("px","")*4,_=+getComputedStyle(c).width.replace("px","")-+getComputedStyle(c).padding.replace("px","")*4,b=Math.min(l/i,_/s);document.documentElement.style.setProperty("--br-height",b+"px"),document.documentElement.style.setProperty("--canvas-border-height",b*i+"px"),document.documentElement.style.setProperty("--canvas-border-width",b*s+"px")}class f{constructor(a,l,_){w(this,"enumStatus");w(this,"enumDimensions");w(this,"enumDirections");w(this,"headAngle");w(this,"canvasWidth");w(this,"canvasHeight");w(this,"countAllBricks");w(this,"speed");w(this,"status");w(this,"headPosition");w(this,"baitPosition");w(this,"oldBaitElement");w(this,"body");w(this,"length");w(this,"direction");w(this,"dimension");w(this,"interval");w(this,"touchParams");this.enumStatus={stopped:0,running:1,paused:2,win:3,null:null},this.enumDimensions={x:0,y:1},this.enumDirections={right:1,down:+a,left:-1,up:-a},this.headAngle=0,this.canvasWidth=a,this.canvasHeight=l,this.countAllBricks=0,this.speed=_,this.status=null,this.headPosition=0,this.baitPosition=null,this.oldBaitElement=null,this.body=[0],this.length=1,this.direction=1,this.dimension=0,this.interval=null,this.touchParams={clientXStart:null,clientYStart:null}}setDirection(a){if(a.preventDefault(),a.key===" ")switch(o.status){case this.enumStatus.running:this.pause();break;default:this.start();break}if(o.status!=this.enumStatus.running)return;const l=[this.dimension,this.direction,this.headAngle];switch(a.key){case"ArrowRight":this.dimension=this.enumDimensions.x,this.direction=this.enumDirections.right,this.headAngle=0;break;case"ArrowDown":this.dimension=this.enumDimensions.y,this.direction=this.enumDirections.down,this.headAngle=90;break;case"ArrowLeft":this.dimension=this.enumDimensions.x,this.direction=this.enumDirections.left,this.headAngle=180;break;case"ArrowUp":this.dimension=this.enumDimensions.y,this.direction=this.enumDirections.up,this.headAngle=270;break}if(this.move("test")===this.body[1]){[this.dimension,this.direction,this.headAngle]=l;return}}touchstart(a){a.preventDefault();const l=a.touches[0];this.touchParams.clientXStart=l.clientX,this.touchParams.clientYStart=l.clientY,o.start()}touchmove(a){const l=a.touches[0],_=l.clientX-this.touchParams.clientXStart,b=l.clientY-this.touchParams.clientYStart;if(Math.abs(_)>50){const g=_>0?"ArrowRight":"ArrowLeft";this.setDirection(new KeyboardEvent("keydown",{key:g}))}else if(Math.abs(b)>50){const g=b>0?"ArrowDown":"ArrowUp";this.setDirection(new KeyboardEvent("keydown",{key:g}))}}touchend(a){this.touchParams.clientXStart=null,this.touchParams.clientYStart=null}rolling(){this.interval=setInterval(()=>{if(n(2,o.status=this.move(),o),this.headPosition===this.baitPosition&&(n(2,o.status=this.eat(),o),n(2,o.status=this.dropBait(),o)),[...this.body].slice(0,this.body.length-1).indexOf(this.headPosition)!=-1){n(2,o.status=this.collapse(),o),this.stop();return}if(n(2,o.status=this.unshiftTheHead(),o),n(2,o.status=this.setBodyColor(),o),this.length===this.countAllBricks){n(2,o.status=this.win(),o),this.stop();return}},1e3/this.speed)}move(a){let l=this.headPosition+this.direction;switch(this.dimension){case this.enumDimensions.x:const _=this.headPosition/this.canvasWidth|0,b=l/this.canvasWidth|0;l=_===b?l<0?l+this.canvasWidth:l:l-this.direction*this.canvasWidth;break;case this.enumDimensions.y:this.headPosition%this.canvasWidth,l%this.canvasWidth,l=l<this.canvasWidth*this.canvasHeight?l<0?l+this.canvasWidth*this.canvasHeight:l:l-this.direction*this.canvasHeight;break}return a?l:(this.headPosition=l,this.enumStatus.running)}eat(){var a;return(a=this.oldBaitElement)==null||a.classList.remove("bait"),this.length++,this.enumStatus.running}dropBait(){const a=[...document.querySelectorAll(".brick:not(.body)")];this.oldBaitElement&&a.splice(a.indexOf(this.oldBaitElement),1);const l=a[Math.random()*a.length|0];return l&&(l.classList.add("bait"),this.baitPosition=+l.className.match(/\d+/)[0],this.oldBaitElement=document.querySelector(".br"+this.baitPosition)),this.enumStatus.running}collapse(){return setTimeout(()=>alert(`You loose! Total eaten bricks:${this.body.length}`),0),this.enumStatus.stopped}unshiftTheHead(){return this.body.unshift(this.headPosition),this.body=this.body.slice(0,this.length),this.enumStatus.running}setBodyColor(){const a=document.querySelectorAll(".body");return a==null||a.forEach(l=>{const _=l==null?void 0:l.className.replace(/body|right|left|down|up|head/g,"");l.className=_}),this.body.forEach((l,_,b)=>{const g=document.querySelector(".br"+l);g.classList.add("body"),_===0&&g.classList.add("head");let y=[null,null];b[_+1]!=null&&(y[0]=b[_+1]-l),b[_-1]!=null&&(y[1]=b[_-1]-l),y.forEach(I=>{switch(I){case this.enumDirections.right:g==null||g.classList.add("right");break;case this.enumDirections.down:g==null||g.classList.add("down");break;case this.enumDirections.left:g==null||g.classList.add("left");break;case this.enumDirections.up:g==null||g.classList.add("up");break}})}),this.enumStatus.running}win(){return setTimeout(()=>{alert(`You win! Total eaten bricks:${this.body.length}`)},0),this.enumStatus.stopped}start(){o.status!==this.enumStatus.running&&(console.log("start"),o.status!=this.enumStatus.paused&&this.reset(),n(2,o.status=this.enumStatus.running,o),canvas==null||canvas.focus(),this.rolling())}stop(){clearInterval(this.interval),this.interval=null}reset(){var a;this.countAllBricks=this.canvasWidth*this.canvasHeight,this.body=[0],this.length=1,this.direction=1,this.headAngle=0,this.dimension=this.enumDimensions.x,this.headPosition=0,this.baitPosition=null,(a=this.oldBaitElement)==null||a.classList.remove("bait"),this.stop(),this.setBodyColor(),this.dropBait(),n(2,o.status=this.enumStatus.paused,o)}pause(){n(2,o.status=this.enumStatus.paused,o),this.stop()}}const o=new f(s,i,r),p=()=>o.start(),S=()=>o.pause(),k=()=>o.reset(),h=c=>o.setDirection(c),d=c=>o.touchstart(c),v=c=>o.touchmove(c),W=c=>o.touchend(c),u=()=>o.start();return t.$$set=c=>{"canvasWidth"in c&&n(0,s=c.canvasWidth),"canvasHeight"in c&&n(1,i=c.canvasHeight),"speed"in c&&n(3,r=c.speed)},[s,i,o,r,p,S,k,h,d,v,W,u]}class Et extends ht{constructor(e){super(),ut(this,e,Lt,Bt,ot,{canvasWidth:0,canvasHeight:1,speed:3})}}function jt(t){let e,n,s;return n=new Et({props:{canvasWidth:10,canvasHeight:10,speed:3}}),{c(){e=P("div"),Pt(n.$$.fragment),C(e,"class","wrapper svelte-1hm245p")},m(i,r){M(i,e,r),lt(n,e,null),s=!0},p:L,i(i){s||(T(n.$$.fragment,i),s=!0)},o(i){It(n.$$.fragment,i),s=!1},d(i){i&&E(e),ct(n)}}}class Dt extends ht{constructor(e){super(),ut(this,e,null,jt,ot,{})}}new Dt({target:document.getElementById("app")});
