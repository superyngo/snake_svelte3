var dt=Object.defineProperty;var ft=(t,e,n)=>e in t?dt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var g=(t,e,n)=>(ft(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();function W(){}function st(t){return t()}function T(){return Object.create(null)}function H(t){t.forEach(st)}function it(t){return typeof t=="function"}function ot(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function mt(t){return Object.keys(t).length===0}function B(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function L(t){t.parentNode&&t.parentNode.removeChild(t)}function P(t){return document.createElement(t)}function pt(t){return document.createTextNode(t)}function x(){return pt(" ")}function E(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function C(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function gt(t){return Array.from(t.childNodes)}function F(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}let N;function X(t){N=t}function rt(){if(!N)throw new Error("Function called outside component initialization");return N}function yt(t){rt().$$.on_mount.push(t)}function wt(t){rt().$$.on_destroy.push(t)}const D=[],z=[];let J=[];const U=[],_t=Promise.resolve();let $=!1;function vt(){$||($=!0,_t.then(at))}function G(t){J.push(t)}const R=new Set;let j=0;function at(){if(j!==0)return;const t=N;do{try{for(;j<D.length;){const e=D[j];j++,X(e),bt(e.$$)}}catch(e){throw D.length=0,j=0,e}for(X(null),D.length=0,j=0;z.length;)z.pop()();for(let e=0;e<J.length;e+=1){const n=J[e];R.has(n)||(R.add(n),n())}J.length=0}while(D.length);for(;U.length;)U.pop()();$=!1,R.clear(),X(t)}function bt(t){if(t.fragment!==null){t.update(),H(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}function kt(t){const e=[],n=[];J.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),J=e}const Y=new Set;let St;function V(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function It(t,e,n,s){if(t&&t.o){if(Y.has(t))return;Y.add(t),St.c.push(()=>{Y.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function q(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Ct(t,e){t.d(1),e.delete(t.key)}function Pt(t,e,n,s,i,c,d,f,r,m,k,b){let u=t.length,h=c.length,_=u;const A={};for(;_--;)A[t[_].key]=_;const o=[],l=new Map,a=new Map,w=[];for(_=h;_--;){const y=b(i,c,_),S=n(y);let I=d.get(S);I?s&&w.push(()=>I.p(y,e)):(I=m(S,y),I.c()),l.set(S,o[_]=I),S in A&&a.set(S,Math.abs(_-A[S]))}const v=new Set,p=new Set;function Z(y){V(y,1),y.m(f,k),d.set(y.key,y),k=y.first,h--}for(;u&&h;){const y=o[h-1],S=t[u-1],I=y.key,O=S.key;y===S?(k=y.first,u--,h--):l.has(O)?!d.has(I)||v.has(I)?Z(y):p.has(O)?u--:a.get(I)>a.get(O)?(p.add(I),Z(y)):(v.add(O),u--):(r(S,d),u--)}for(;u--;){const y=t[u];l.has(y.key)||r(y,d)}for(;h;)Z(o[h-1]);return H(w),o}function At(t){t&&t.c()}function lt(t,e,n){const{fragment:s,after_update:i}=t.$$;s&&s.m(e,n),G(()=>{const c=t.$$.on_mount.map(st).filter(it);t.$$.on_destroy?t.$$.on_destroy.push(...c):H(c),t.$$.on_mount=[]}),i.forEach(G)}function ct(t,e){const n=t.$$;n.fragment!==null&&(kt(n.after_update),H(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Wt(t,e){t.$$.dirty[0]===-1&&(D.push(t),vt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(t,e,n,s,i,c,d,f=[-1]){const r=N;X(t);const m=t.$$={fragment:null,ctx:[],props:c,update:W,not_equal:i,bound:T(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(r?r.$$.context:[])),callbacks:T(),dirty:f,skip_bound:!1,root:e.target||r.$$.root};d&&d(m.root);let k=!1;if(m.ctx=n?n(t,e.props||{},(b,u,...h)=>{const _=h.length?h[0]:u;return m.ctx&&i(m.ctx[b],m.ctx[b]=_)&&(!m.skip_bound&&m.bound[b]&&m.bound[b](_),k&&Wt(t,b)),u}):[],m.update(),k=!0,H(m.before_update),m.fragment=s?s(m.ctx):!1,e.target){if(e.hydrate){const b=gt(e.target);m.fragment&&m.fragment.l(b),b.forEach(L)}else m.fragment&&m.fragment.c();e.intro&&V(t.$$.fragment),lt(t,e.target,e.anchor),at()}X(r)}class ht{constructor(){g(this,"$$");g(this,"$$set")}$destroy(){ct(this,1),this.$destroy=W}$on(e,n){if(!it(n))return W;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!mt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Zt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Zt);function Q(t,e,n){const s=t.slice();return s[13]=e[n],s[15]=n,s}function K(t){let e,n,s;return{c(){e=P("button"),e.textContent="start"},m(i,c){M(i,e,c),n||(s=E(e,"click",t[4]),n=!0)},p:W,d(i){i&&L(e),n=!1,s()}}}function tt(t){let e,n,s;return{c(){e=P("button"),e.textContent="pause"},m(i,c){M(i,e,c),n||(s=E(e,"click",t[5]),n=!0)},p:W,d(i){i&&L(e),n=!1,s()}}}function et(t){let e;return{c(){e=P("div"),e.innerHTML='<div class="tongue svelte-1a5ksi8"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketchjs="https://sketch.io/dtd/" sketchjs:metadata="eyJuYW1lIjoiRHJhd2luZy0zLnNrZXRjaHBhZCIsInN1cmZhY2UiOnsiaXNQYWludCI6dHJ1ZSwibWV0aG9kIjoiZmlsbCIsImJsZW5kIjoibm9ybWFsIiwiZW5hYmxlZCI6dHJ1ZSwib3BhY2l0eSI6MSwidHlwZSI6InBhdHRlcm4iLCJwYXR0ZXJuIjp7InR5cGUiOiJwYXR0ZXJuIiwicmVmbGVjdCI6Im5vLXJlZmxlY3QiLCJyZXBlYXQiOiJyZXBlYXQiLCJzbW9vdGhpbmciOmZhbHNlLCJzcmMiOiJ0cmFuc3BhcmVudExpZ2h0Iiwic3giOjEsInN5IjoxLCJ4MCI6MC41LCJ4MSI6MSwieTAiOjAuNSwieTEiOjF9LCJpc0ZpbGwiOnRydWV9LCJjbGlwUGF0aCI6eyJlbmFibGVkIjp0cnVlLCJzdHlsZSI6eyJzdHJva2VTdHlsZSI6ImJsYWNrIiwibGluZVdpZHRoIjoxfX0sImRlc2NyaXB0aW9uIjoiTWFkZSB3aXRoIFNrZXRjaHBhZCIsIm1ldGFkYXRhIjp7fSwiZXhwb3J0RFBJIjo3MiwiZXhwb3J0Rm9ybWF0IjoicG5nIiwiZXhwb3J0UXVhbGl0eSI6MC45NSwidW5pdHMiOiJweCIsIndpZHRoIjozMDAsImhlaWdodCI6MjAwLCJwYWdlcyI6W3sid2lkdGgiOjMwMCwiaGVpZ2h0IjoyMDB9XSwidXVpZCI6IjgxZTU3N2I2LWE2ZmYtNDNkNS1hNGU3LWQ0ZWVmMThhMjVkOCJ9" width="50" height="200" viewBox="0 0 300 200"><path style="fill: #d7066f; stroke: #000000; mix-blend-mode: source-over; paint-order: stroke fill markers; fill-opacity: 1; stroke-dasharray: none; stroke-dashoffset: 0; stroke-linecap: round; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1; stroke-width: 4;" sketchjs:tool="path" d="M9.96 32.41 C31.96 5.41 54.96 -11.59 94.96 9.41 128.96 22.41 135.96 65.41 185.96 64.41 242.96 67.41 295.96 20.41 295.96 20.41 295.96 20.41 247.96 64.41 246.96 64.41 245.96 64.41 317.96 41.41 316.96 41.41 315.96 41.41 194.96 104.41 165.96 110.41 136.96 116.41 129.96 60.41 55.96 66.41 17.96 76.41 12.96 134.41 10.96 134.41 8.96 134.41 -12.04 59.41 9.96 32.41 z" transform="matrix(1,0,0,1,-15.9598774,34.5922776)"></path></svg></div>',C(e,"class","face svelte-1a5ksi8")},m(n,s){M(n,e,s)},d(n){n&&L(e)}}}function nt(t,e){let n,s,i,c=e[15]===e[2].body[0]&&e[2].status!=e[2].enumStatus.null&&et();return{key:t,first:null,c(){n=P("div"),c&&c.c(),s=x(),C(n,"class",i="brick br"+e[15]+" svelte-1a5ksi8"),this.first=n},m(d,f){M(d,n,f),c&&c.m(n,null),B(n,s)},p(d,f){e=d,e[15]===e[2].body[0]&&e[2].status!=e[2].enumStatus.null?c||(c=et(),c.c(),c.m(n,s)):c&&(c.d(1),c=null),f&3&&i!==(i="brick br"+e[15]+" svelte-1a5ksi8")&&C(n,"class",i)},d(d){d&&L(n),c&&c.d()}}}function Bt(t){let e,n,s,i,c,d,f,r=[],m=new Map,k,b,u=t[2].status!=t[2].enumStatus.running&&K(t),h=t[2].status===t[2].enumStatus.running&&tt(t),_=q(Array(t[0]*t[1]));const A=o=>o[15];for(let o=0;o<_.length;o+=1){let l=Q(t,_,o),a=A(l);m.set(a,r[o]=nt(a,l))}return{c(){e=P("div"),n=P("div"),u&&u.c(),s=x(),h&&h.c(),i=x(),c=P("button"),c.textContent="reset",d=x(),f=P("div");for(let o=0;o<r.length;o+=1)r[o].c();C(n,"class","control svelte-1a5ksi8"),C(f,"id","canvas"),C(f,"role","button"),C(f,"tabindex",0),F(f,"grid-template-columns","repeat("+t[0]+", auto)"),C(f,"class","svelte-1a5ksi8"),C(e,"class","appWrapper svelte-1a5ksi8")},m(o,l){M(o,e,l),B(e,n),u&&u.m(n,null),B(n,s),h&&h.m(n,null),B(n,i),B(n,c),B(e,d),B(e,f);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(f,null);k||(b=[E(c,"click",t[6]),E(f,"keydown",t[7]),E(f,"touchstart",t[8]),E(f,"touchmove",t[9]),E(f,"touchend",t[10])],k=!0)},p(o,[l]){o[2].status!=o[2].enumStatus.running?u?u.p(o,l):(u=K(o),u.c(),u.m(n,s)):u&&(u.d(1),u=null),o[2].status===o[2].enumStatus.running?h?h.p(o,l):(h=tt(o),h.c(),h.m(n,i)):h&&(h.d(1),h=null),l&7&&(_=q(Array(o[0]*o[1])),r=Pt(r,l,A,1,o,_,m,f,Ct,nt,null,Q)),l&1&&F(f,"grid-template-columns","repeat("+o[0]+", auto)")},i:W,o:W,d(o){o&&L(e),u&&u.d(),h&&h.d();for(let l=0;l<r.length;l+=1)r[l].d();k=!1,H(b)}}}function Et(t,e,n){let{canvasWidth:s=10,canvasHeight:i=10,speed:c=5}=e;yt(()=>{const o=document.getElementById("canvas");d(),o.focus(),window.onresize=d}),wt(()=>r.stop());function d(){const o=document.querySelector(".appWrapper"),l=document.querySelector(".control"),a=+getComputedStyle(o).height.replace("px","")-+getComputedStyle(l).height.replace("px","")-+getComputedStyle(o).padding.replace("px","")*4,w=+getComputedStyle(o).width.replace("px",""),v=Math.min(a/i,w/s);document.documentElement.style.setProperty("--br-height",v+"px"),document.documentElement.style.setProperty("--canvas-border-height",v*i+"px"),document.documentElement.style.setProperty("--canvas-border-width",v*s+"px")}class f{constructor(l,a,w){g(this,"enumStatus");g(this,"enumDimensions");g(this,"enumDirections");g(this,"headAngle");g(this,"canvasWidth");g(this,"canvasHeight");g(this,"countAllBricks");g(this,"speed");g(this,"status");g(this,"headPosition");g(this,"baitPosition");g(this,"oldBaitElement");g(this,"body");g(this,"length");g(this,"direction");g(this,"dimension");g(this,"interval");g(this,"touchParams");this.enumStatus={stopped:0,running:1,paused:2,win:3,null:null},this.enumDimensions={x:0,y:1},this.enumDirections={right:1,down:+l,left:-1,up:-l},this.headAngle=0,this.canvasWidth=l,this.canvasHeight=a,this.countAllBricks=0,this.speed=w,this.status=null,this.headPosition=0,this.baitPosition=null,this.oldBaitElement=null,this.body=[0],this.length=1,this.direction=1,this.dimension=0,this.interval=null,this.touchParams={clientXStart:null,clientYStart:null}}setDirection(l){if(l.preventDefault,l.key===" ")switch(r.status){case this.enumStatus.running:this.pause();break;default:this.start();break}if(r.status!=this.enumStatus.running)return;const a=[this.dimension,this.direction];switch(l.key){case"ArrowRight":this.dimension=this.enumDimensions.x,this.direction=this.enumDirections.right,this.headAngle=0;break;case"ArrowDown":this.dimension=this.enumDimensions.y,this.direction=this.enumDirections.down,this.headAngle=90;break;case"ArrowLeft":this.dimension=this.enumDimensions.x,this.direction=this.enumDirections.left,this.headAngle=180;break;case"ArrowUp":this.dimension=this.enumDimensions.y,this.direction=this.enumDirections.up,this.headAngle=270;break}if(this.move("test")===this.body[1]){[this.dimension,this.direction]=a;return}document.documentElement.style.setProperty("--head-angle",this.headAngle+"deg")}touchstart(l){l.preventDefault();const a=l.touches[0];this.touchParams.clientXStart=a.clientX,this.touchParams.clientYStart=a.clientY}touchmove(l){const a=l.touches[0],w=a.clientX-this.touchParams.clientXStart,v=a.clientY-this.touchParams.clientYStart;if(Math.abs(w)>50){const p=w>0?"ArrowRight":"ArrowLeft";this.setDirection(new KeyboardEvent("keydown",{key:p}))}else if(Math.abs(v)>50){const p=v>0?"ArrowDown":"ArrowUp";this.setDirection(new KeyboardEvent("keydown",{key:p}))}}touchend(l){this.touchParams.clientXStart=null,this.touchParams.clientYStart=null}rolling(){this.interval=setInterval(()=>{if(n(2,r.status=this.move(),r),this.headPosition===this.baitPosition&&(n(2,r.status=this.eat(),r),n(2,r.status=this.dropBait(),r)),[...this.body].slice(0,this.body.length-1).indexOf(this.headPosition)!=-1){n(2,r.status=this.collapse(),r),this.stop();return}if(n(2,r.status=this.unshiftTheHead(),r),n(2,r.status=this.setBodyColor(),r),this.length===this.countAllBricks){n(2,r.status=this.win(),r),this.stop();return}},1e3/this.speed)}move(l){let a=this.headPosition+this.direction;switch(this.dimension){case this.enumDimensions.x:const w=this.headPosition/this.canvasWidth|0,v=a/this.canvasWidth|0;a=w===v?a<0?a+this.canvasWidth:a:a-this.direction*this.canvasWidth;break;case this.enumDimensions.y:this.headPosition%this.canvasWidth,a%this.canvasWidth,a=a<this.canvasWidth*this.canvasHeight?a<0?a+this.canvasWidth*this.canvasHeight:a:a-this.direction*this.canvasHeight;break}return l?a:(this.headPosition=a,this.enumStatus.running)}eat(){var l;return(l=this.oldBaitElement)==null||l.classList.remove("bait"),this.length++,this.enumStatus.running}dropBait(){const l=[...document.querySelectorAll(".brick:not(.body)")];this.oldBaitElement&&l.splice(l.indexOf(this.oldBaitElement),1);const a=l[Math.random()*l.length|0];return a&&(a.classList.add("bait"),this.baitPosition=+a.className.match(/\d+/)[0],this.oldBaitElement=document.querySelector(".br"+this.baitPosition)),this.enumStatus.running}collapse(){return alert(`You loose! Total eaten bricks:${this.body.length}`),this.enumStatus.stopped}unshiftTheHead(){return this.body.unshift(this.headPosition),this.body=this.body.slice(0,this.length),this.enumStatus.running}setBodyColor(){const l=document.querySelectorAll(".body");return l==null||l.forEach(a=>{const w=a==null?void 0:a.className.replace(/body|right|left|down|up|head/g,"");a.className=w}),this.body.forEach((a,w,v)=>{const p=document.querySelector(".br"+a);p.classList.add("body"),w===0&&p.classList.add("head");let Z=[null,null];v[w+1]!=null&&(Z[0]=v[w+1]-a),v[w-1]!=null&&(Z[1]=v[w-1]-a),Z.forEach(y=>{switch(y){case this.enumDirections.right:p==null||p.classList.add("right");break;case this.enumDirections.down:p==null||p.classList.add("down");break;case this.enumDirections.left:p==null||p.classList.add("left");break;case this.enumDirections.up:p==null||p.classList.add("up");break}})}),this.enumStatus.running}win(){return setTimeout(()=>{alert(`You win! Total eaten bricks:${this.body.length}`)},0),this.enumStatus.stopped}start(){r.status!==this.enumStatus.running&&(console.log("start"),r.status!=this.enumStatus.paused&&this.reset(),n(2,r.status=this.enumStatus.running,r),canvas==null||canvas.focus(),this.rolling())}stop(){clearInterval(this.interval),this.interval=null}reset(){var l;this.countAllBricks=this.canvasWidth*this.canvasHeight,this.body=[0],this.length=1,this.direction=1,this.headAngle=0,this.dimension=this.enumDimensions.x,this.headPosition=0,this.baitPosition=null,(l=this.oldBaitElement)==null||l.classList.remove("bait"),this.stop(),this.setBodyColor(),this.dropBait(),n(2,r.status=this.enumStatus.paused,r)}pause(){n(2,r.status=this.enumStatus.paused,r),this.stop()}}const r=new f(s,i,c),m=()=>r.start(),k=()=>r.pause(),b=()=>r.reset(),u=o=>r.setDirection(o),h=o=>r.touchstart(o),_=o=>r.touchmove(o),A=o=>r.touchend(o);return t.$$set=o=>{"canvasWidth"in o&&n(0,s=o.canvasWidth),"canvasHeight"in o&&n(1,i=o.canvasHeight),"speed"in o&&n(3,c=o.speed)},[s,i,r,c,m,k,b,u,h,_,A]}class Lt extends ht{constructor(e){super(),ut(this,e,Et,Bt,ot,{canvasWidth:0,canvasHeight:1,speed:3})}}function jt(t){let e,n,s;return n=new Lt({props:{canvasWidth:10,canvasHeight:10,speed:3}}),{c(){e=P("div"),At(n.$$.fragment),C(e,"class","wrapper svelte-1ca1rez")},m(i,c){M(i,e,c),lt(n,e,null),s=!0},p:W,i(i){s||(V(n.$$.fragment,i),s=!0)},o(i){It(n.$$.fragment,i),s=!1},d(i){i&&L(e),ct(n)}}}class Dt extends ht{constructor(e){super(),ut(this,e,null,jt,ot,{})}}new Dt({target:document.getElementById("app")});
