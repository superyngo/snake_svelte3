var dt=Object.defineProperty;var ft=(t,e,n)=>e in t?dt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var _=(t,e,n)=>(ft(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const g of r.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&s(g)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function L(){}function st(t){return t()}function F(){return Object.create(null)}function M(t){t.forEach(st)}function it(t){return typeof t=="function"}function ot(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function mt(t){return Object.keys(t).length===0}function E(t,e){t.appendChild(e)}function H(t,e,n){t.insertBefore(e,n||null)}function Z(t){t.parentNode&&t.parentNode.removeChild(t)}function W(t){return document.createElement(t)}function pt(t){return document.createTextNode(t)}function O(){return pt(" ")}function C(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function P(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function gt(t){return Array.from(t.childNodes)}function x(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}let N;function Y(t){N=t}function rt(){if(!N)throw new Error("Function called outside component initialization");return N}function yt(t){rt().$$.on_mount.push(t)}function wt(t){rt().$$.on_destroy.push(t)}const j=[],U=[];let J=[];const z=[],_t=Promise.resolve();let G=!1;function vt(){G||(G=!0,_t.then(at))}function V(t){J.push(t)}const $=new Set;let X=0;function at(){if(X!==0)return;const t=N;do{try{for(;X<j.length;){const e=j[X];X++,Y(e),bt(e.$$)}}catch(e){throw j.length=0,X=0,e}for(Y(null),j.length=0,X=0;U.length;)U.pop()();for(let e=0;e<J.length;e+=1){const n=J[e];$.has(n)||($.add(n),n())}J.length=0}while(j.length);for(;z.length;)z.pop()();G=!1,$.clear(),Y(t)}function bt(t){if(t.fragment!==null){t.update(),M(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(V)}}function kt(t){const e=[],n=[];J.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),J=e}const R=new Set;let St;function T(t,e){t&&t.i&&(R.delete(t),t.i(e))}function It(t,e,n,s){if(t&&t.o){if(R.has(t))return;R.add(t),St.c.push(()=>{R.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function q(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function At(t,e){t.d(1),e.delete(t.key)}function Pt(t,e,n,s,i,r,g,m,o,y,A,k){let h=t.length,p=r.length,b=h;const D={};for(;b--;)D[t[b].key]=b;const u=[],v=new Map,I=new Map,d=[];for(b=p;b--;){const c=k(i,r,b),f=n(c);let S=g.get(f);S?s&&d.push(()=>S.p(c,e)):(S=y(f,c),S.c()),v.set(f,u[b]=S),f in D&&I.set(f,Math.abs(b-D[f]))}const l=new Set,a=new Set;function w(c){T(c,1),c.m(m,A),g.set(c.key,c),A=c.first,p--}for(;h&&p;){const c=u[p-1],f=t[h-1],S=c.key,B=f.key;c===f?(A=c.first,h--,p--):v.has(B)?!g.has(S)||l.has(S)?w(c):a.has(B)?h--:I.get(S)>I.get(B)?(a.add(S),w(c)):(l.add(B),h--):(o(f,g),h--)}for(;h--;){const c=t[h];v.has(c.key)||o(c,g)}for(;p;)w(u[p-1]);return M(d),u}function Ct(t){t&&t.c()}function lt(t,e,n){const{fragment:s,after_update:i}=t.$$;s&&s.m(e,n),V(()=>{const r=t.$$.on_mount.map(st).filter(it);t.$$.on_destroy?t.$$.on_destroy.push(...r):M(r),t.$$.on_mount=[]}),i.forEach(V)}function ct(t,e){const n=t.$$;n.fragment!==null&&(kt(n.after_update),M(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Wt(t,e){t.$$.dirty[0]===-1&&(j.push(t),vt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(t,e,n,s,i,r,g,m=[-1]){const o=N;Y(t);const y=t.$$={fragment:null,ctx:[],props:r,update:L,not_equal:i,bound:F(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:F(),dirty:m,skip_bound:!1,root:e.target||o.$$.root};g&&g(y.root);let A=!1;if(y.ctx=n?n(t,e.props||{},(k,h,...p)=>{const b=p.length?p[0]:h;return y.ctx&&i(y.ctx[k],y.ctx[k]=b)&&(!y.skip_bound&&y.bound[k]&&y.bound[k](b),A&&Wt(t,k)),h}):[],y.update(),A=!0,M(y.before_update),y.fragment=s?s(y.ctx):!1,e.target){if(e.hydrate){const k=gt(e.target);y.fragment&&y.fragment.l(k),k.forEach(Z)}else y.fragment&&y.fragment.c();e.intro&&T(t.$$.fragment),lt(t,e.target,e.anchor),at()}Y(o)}class ht{constructor(){_(this,"$$");_(this,"$$set")}$destroy(){ct(this,1),this.$destroy=L}$on(e,n){if(!it(n))return L;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!mt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Dt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Dt);function K(t,e,n){const s=t.slice();return s[16]=e[n],s[18]=n,s}function Q(t){let e,n,s;return{c(){e=W("button"),e.textContent="start"},m(i,r){H(i,e,r),n||(s=C(e,"click",t[4]),n=!0)},p:L,d(i){i&&Z(e),n=!1,s()}}}function tt(t){let e,n,s;return{c(){e=W("button"),e.textContent="pause"},m(i,r){H(i,e,r),n||(s=C(e,"click",t[5]),n=!0)},p:L,d(i){i&&Z(e),n=!1,s()}}}function et(t){let e,n;return{c(){e=W("div"),n=W("div"),n.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketchjs="https://sketch.io/dtd/" sketchjs:metadata="eyJuYW1lIjoiRHJhd2luZy0zLnNrZXRjaHBhZCIsInN1cmZhY2UiOnsiaXNQYWludCI6dHJ1ZSwibWV0aG9kIjoiZmlsbCIsImJsZW5kIjoibm9ybWFsIiwiZW5hYmxlZCI6dHJ1ZSwib3BhY2l0eSI6MSwidHlwZSI6InBhdHRlcm4iLCJwYXR0ZXJuIjp7InR5cGUiOiJwYXR0ZXJuIiwicmVmbGVjdCI6Im5vLXJlZmxlY3QiLCJyZXBlYXQiOiJyZXBlYXQiLCJzbW9vdGhpbmciOmZhbHNlLCJzcmMiOiJ0cmFuc3BhcmVudExpZ2h0Iiwic3giOjEsInN5IjoxLCJ4MCI6MC41LCJ4MSI6MSwieTAiOjAuNSwieTEiOjF9LCJpc0ZpbGwiOnRydWV9LCJjbGlwUGF0aCI6eyJlbmFibGVkIjp0cnVlLCJzdHlsZSI6eyJzdHJva2VTdHlsZSI6ImJsYWNrIiwibGluZVdpZHRoIjoxfX0sImRlc2NyaXB0aW9uIjoiTWFkZSB3aXRoIFNrZXRjaHBhZCIsIm1ldGFkYXRhIjp7fSwiZXhwb3J0RFBJIjo3MiwiZXhwb3J0Rm9ybWF0IjoicG5nIiwiZXhwb3J0UXVhbGl0eSI6MC45NSwidW5pdHMiOiJweCIsIndpZHRoIjozMDAsImhlaWdodCI6MjAwLCJwYWdlcyI6W3sid2lkdGgiOjMwMCwiaGVpZ2h0IjoyMDB9XSwidXVpZCI6IjgxZTU3N2I2LWE2ZmYtNDNkNS1hNGU3LWQ0ZWVmMThhMjVkOCJ9" width="50" height="200" viewBox="0 0 300 200"><path style="fill: #d7066f; stroke: #000000; mix-blend-mode: source-over; paint-order: stroke fill markers; fill-opacity: 1; stroke-dasharray: none; stroke-dashoffset: 0; stroke-linecap: round; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1; stroke-width: 4;" sketchjs:tool="path" d="M9.96 32.41 C31.96 5.41 54.96 -11.59 94.96 9.41 128.96 22.41 135.96 65.41 185.96 64.41 242.96 67.41 295.96 20.41 295.96 20.41 295.96 20.41 247.96 64.41 246.96 64.41 245.96 64.41 317.96 41.41 316.96 41.41 315.96 41.41 194.96 104.41 165.96 110.41 136.96 116.41 129.96 60.41 55.96 66.41 17.96 76.41 12.96 134.41 10.96 134.41 8.96 134.41 -12.04 59.41 9.96 32.41 z" transform="matrix(1,0,0,1,-15.9598774,34.5922776)"></path></svg>',P(n,"class","tongue svelte-1a5ksi8"),P(e,"class","face svelte-1a5ksi8"),x(e,"rotate",t[2].headAngle+"deg")},m(s,i){H(s,e,i),E(e,n)},p(s,i){i&4&&x(e,"rotate",s[2].headAngle+"deg")},d(s){s&&Z(e)}}}function nt(t,e){let n,s,i,r=e[18]===e[2].body[0]&&e[2].status!=e[2].enumStatus.null&&et(e);return{key:t,first:null,c(){n=W("div"),r&&r.c(),s=O(),P(n,"class",i="brick br"+e[18]+" svelte-1a5ksi8"),this.first=n},m(g,m){H(g,n,m),r&&r.m(n,null),E(n,s)},p(g,m){e=g,e[18]===e[2].body[0]&&e[2].status!=e[2].enumStatus.null?r?r.p(e,m):(r=et(e),r.c(),r.m(n,s)):r&&(r.d(1),r=null),m&3&&i!==(i="brick br"+e[18]+" svelte-1a5ksi8")&&P(n,"class",i)},d(g){g&&Z(n),r&&r.d()}}}function Et(t){let e,n,s,i,r,g,m,o=[],y=new Map,A,k,h=t[2].status!=t[2].enumStatus.running&&Q(t),p=t[2].status===t[2].enumStatus.running&&tt(t),b=q(Array(t[0]*t[1]));const D=u=>u[18];for(let u=0;u<b.length;u+=1){let v=K(t,b,u),I=D(v);y.set(I,o[u]=nt(I,v))}return{c(){e=W("div"),n=W("div"),h&&h.c(),s=O(),p&&p.c(),i=O(),r=W("button"),r.textContent="reset",g=O(),m=W("div");for(let u=0;u<o.length;u+=1)o[u].c();P(n,"class","control svelte-1a5ksi8"),P(m,"id","canvas"),P(m,"role","button"),P(m,"tabindex",0),x(m,"grid-template-columns","repeat("+t[0]+", auto)"),P(m,"class","svelte-1a5ksi8"),P(e,"class","appWrapper svelte-1a5ksi8")},m(u,v){H(u,e,v),E(e,n),h&&h.m(n,null),E(n,s),p&&p.m(n,null),E(n,i),E(n,r),E(e,g),E(e,m);for(let I=0;I<o.length;I+=1)o[I]&&o[I].m(m,null);A||(k=[C(r,"click",t[6]),C(m,"keydown",t[7]),C(m,"touchstart",t[8]),C(m,"touchmove",t[9]),C(m,"touchend",t[10]),C(m,"click",t[11]),C(m,"mousedown",t[12]),C(m,"mouseup",t[13])],A=!0)},p(u,[v]){u[2].status!=u[2].enumStatus.running?h?h.p(u,v):(h=Q(u),h.c(),h.m(n,s)):h&&(h.d(1),h=null),u[2].status===u[2].enumStatus.running?p?p.p(u,v):(p=tt(u),p.c(),p.m(n,i)):p&&(p.d(1),p=null),v&7&&(b=q(Array(u[0]*u[1])),o=Pt(o,v,D,1,u,b,y,m,At,nt,null,K)),v&1&&x(m,"grid-template-columns","repeat("+u[0]+", auto)")},i:L,o:L,d(u){u&&Z(e),h&&h.d(),p&&p.d();for(let v=0;v<o.length;v+=1)o[v].d();A=!1,M(k)}}}function Lt(t,e,n){let{canvasWidth:s=10,canvasHeight:i=10,speed:r=5}=e;yt(()=>{const d=document.getElementById("canvas");g(),d.focus(),window.onresize=g}),wt(()=>o.stop());function g(){const d=document.querySelector(".appWrapper"),l=document.querySelector(".control"),a=+getComputedStyle(d).height.replace("px","")-+getComputedStyle(l).height.replace("px","")-+getComputedStyle(d).padding.replace("px","")*4,w=+getComputedStyle(d).width.replace("px","")-+getComputedStyle(d).padding.replace("px","")*4,c=Math.min(a/i,w/s);document.documentElement.style.setProperty("--br-height",c+"px"),document.documentElement.style.setProperty("--canvas-border-height",c*i+"px"),document.documentElement.style.setProperty("--canvas-border-width",c*s+"px")}class m{constructor(l,a,w){_(this,"enumStatus");_(this,"enumDimensions");_(this,"enumDirections");_(this,"headAngle");_(this,"canvasWidth");_(this,"canvasHeight");_(this,"countAllBricks");_(this,"speed");_(this,"status");_(this,"headPosition");_(this,"baitPosition");_(this,"oldBaitElement");_(this,"body");_(this,"length");_(this,"direction");_(this,"dimension");_(this,"interval");_(this,"touchParams");this.enumStatus={stopped:0,running:1,paused:2,win:3,null:null},this.enumDimensions={x:0,y:1},this.enumDirections={right:1,down:+l,left:-1,up:-l},this.headAngle=0,this.canvasWidth=l,this.canvasHeight=a,this.countAllBricks=0,this.speed=w,this.status=null,this.headPosition=0,this.baitPosition=null,this.oldBaitElement=null,this.body=[0],this.length=1,this.direction=1,this.dimension=0,this.interval=null,this.touchParams={clientXStart:null,clientYStart:null}}setDirection(l){if(l.key!="F12"&&l.preventDefault(),l.key===" ")switch(o.status){case this.enumStatus.running:this.pause();break;default:this.start();break}if(o.status!=this.enumStatus.running)return;const a=[this.dimension,this.direction,this.headAngle];switch(l.key){case"ArrowRight":this.dimension=this.enumDimensions.x,this.direction=this.enumDirections.right,this.headAngle=0;break;case"ArrowDown":this.dimension=this.enumDimensions.y,this.direction=this.enumDirections.down,this.headAngle=90;break;case"ArrowLeft":this.dimension=this.enumDimensions.x,this.direction=this.enumDirections.left,this.headAngle=180;break;case"ArrowUp":this.dimension=this.enumDimensions.y,this.direction=this.enumDirections.up,this.headAngle=270;break}if(this.move("test")===this.body[1]){[this.dimension,this.direction,this.headAngle]=a;return}}touchstart(l){l.preventDefault();const a=l.touches[0];this.touchParams.clientXStart=a.clientX,this.touchParams.clientYStart=a.clientY,o.start()}touchmove(l){const a=l.touches[0],w=a.clientX-this.touchParams.clientXStart,c=a.clientY-this.touchParams.clientYStart;if(Math.abs(w)>50){const f=w>0?"ArrowRight":"ArrowLeft";this.setDirection(new KeyboardEvent("keydown",{key:f}))}else if(Math.abs(c)>50){const f=c>0?"ArrowDown":"ArrowUp";this.setDirection(new KeyboardEvent("keydown",{key:f}))}}touchend(l){this.touchParams.clientXStart=null,this.touchParams.clientYStart=null}mousedown(l){l.preventDefault(),this.touchParams.clientXStart=l.clientX,this.touchParams.clientYStart=l.clientY}mouseup(l){const a=l.clientX-this.touchParams.clientXStart,w=l.clientY-this.touchParams.clientYStart;if(Math.abs(a)>50){const c=a>0?"ArrowRight":"ArrowLeft";this.setDirection(new KeyboardEvent("keydown",{key:c}))}else if(Math.abs(w)>50){const c=w>0?"ArrowDown":"ArrowUp";this.setDirection(new KeyboardEvent("keydown",{key:c}))}this.touchParams.clientXStart=null,this.touchParams.clientYStart=null}rolling(){this.interval=setInterval(()=>{if(n(2,o.status=this.move(),o),this.headPosition===this.baitPosition&&(n(2,o.status=this.eat(),o),n(2,o.status=this.dropBait(),o)),[...this.body].slice(0,this.body.length-1).indexOf(this.headPosition)!=-1){n(2,o.status=this.collapse(),o),this.stop();return}if(n(2,o.status=this.unshiftTheHead(),o),n(2,o.status=this.setBodyColor(),o),this.length===this.countAllBricks){n(2,o.status=this.win(),o),this.stop();return}},1e3/this.speed)}move(l){let a=this.headPosition+this.direction;switch(this.dimension){case this.enumDimensions.x:const w=this.headPosition/this.canvasWidth|0,c=a/this.canvasWidth|0;a=w===c?a<0?a+this.canvasWidth:a:a-this.direction*this.canvasWidth;break;case this.enumDimensions.y:this.headPosition%this.canvasWidth,a%this.canvasWidth,a=a<this.canvasWidth*this.canvasHeight?a<0?a+this.canvasWidth*this.canvasHeight:a:a-this.direction*this.canvasHeight;break}return l?a:(this.headPosition=a,this.enumStatus.running)}eat(){var l;return(l=this.oldBaitElement)==null||l.classList.remove("bait"),this.length++,this.enumStatus.running}dropBait(){const l=[...document.querySelectorAll(".brick:not(.body)")];this.oldBaitElement&&l.splice(l.indexOf(this.oldBaitElement),1);const a=l[Math.random()*l.length|0];return a&&(a.classList.add("bait"),this.baitPosition=+a.className.match(/\d+/)[0],this.oldBaitElement=document.querySelector(".br"+this.baitPosition)),this.enumStatus.running}collapse(){return setTimeout(()=>alert(`You loose! Total eaten bricks:${this.body.length}`),0),this.enumStatus.stopped}unshiftTheHead(){return this.body.unshift(this.headPosition),this.body=this.body.slice(0,this.length),this.enumStatus.running}setBodyColor(){const l=document.querySelectorAll(".body");return l==null||l.forEach(a=>{const w=a==null?void 0:a.className.replace(/body|right|left|down|up|head/g,"");a.className=w}),this.body.forEach((a,w,c)=>{const f=document.querySelector(".br"+a);f.classList.add("body"),w===0&&f.classList.add("head");let S=[null,null];c[w+1]!=null&&(S[0]=c[w+1]-a),c[w-1]!=null&&(S[1]=c[w-1]-a),S.forEach(B=>{switch(B){case this.enumDirections.right:f==null||f.classList.add("right");break;case this.enumDirections.down:f==null||f.classList.add("down");break;case this.enumDirections.left:f==null||f.classList.add("left");break;case this.enumDirections.up:f==null||f.classList.add("up");break}})}),this.enumStatus.running}win(){return setTimeout(()=>{alert(`You win! Total eaten bricks:${this.body.length}`)},0),this.enumStatus.stopped}start(){o.status!==this.enumStatus.running&&(console.log("start"),o.status!=this.enumStatus.paused&&this.reset(),n(2,o.status=this.enumStatus.running,o),canvas==null||canvas.focus(),this.rolling())}stop(){clearInterval(this.interval),this.interval=null}reset(){var l;this.countAllBricks=this.canvasWidth*this.canvasHeight,this.body=[0],this.length=1,this.direction=1,this.headAngle=0,this.dimension=this.enumDimensions.x,this.headPosition=0,this.baitPosition=null,(l=this.oldBaitElement)==null||l.classList.remove("bait"),this.stop(),this.setBodyColor(),this.dropBait(),n(2,o.status=this.enumStatus.paused,o)}pause(){n(2,o.status=this.enumStatus.paused,o),this.stop()}}const o=new m(s,i,r),y=()=>o.start(),A=()=>o.pause(),k=()=>o.reset(),h=d=>o.setDirection(d),p=d=>o.touchstart(d),b=d=>o.touchmove(d),D=d=>o.touchend(d),u=()=>o.start(),v=d=>o.mousedown(d),I=d=>o.mouseup(d);return t.$$set=d=>{"canvasWidth"in d&&n(0,s=d.canvasWidth),"canvasHeight"in d&&n(1,i=d.canvasHeight),"speed"in d&&n(3,r=d.speed)},[s,i,o,r,y,A,k,h,p,b,D,u,v,I]}class Zt extends ht{constructor(e){super(),ut(this,e,Lt,Et,ot,{canvasWidth:0,canvasHeight:1,speed:3})}}function Bt(t){let e,n,s;return n=new Zt({props:{canvasWidth:10,canvasHeight:10,speed:3}}),{c(){e=W("div"),Ct(n.$$.fragment),P(e,"class","wrapper svelte-1hm245p")},m(i,r){H(i,e,r),lt(n,e,null),s=!0},p:L,i(i){s||(T(n.$$.fragment,i),s=!0)},o(i){It(n.$$.fragment,i),s=!1},d(i){i&&Z(e),ct(n)}}}class Xt extends ht{constructor(e){super(),ut(this,e,null,Bt,ot,{})}}new Xt({target:document.getElementById("app")});
